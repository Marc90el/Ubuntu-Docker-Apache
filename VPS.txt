 -
apt update && apt upgrade && apt autoremove && snap refresh
apt install sudo nano software-properties-common
adduser marcel
usermod -aG sudo marcel

sudo -s
passwd -l root

nano /etc/ssh/sshd_config
PermitRootLogin no

fallocate -l 4G /swapfile
chmod 600 /swapfile
mkswap /swapfile
swapon /swapfile

nano /etc/fstab
/swapfile none swap sw 0 0

apt install docker.io
systemctl enable --now docker
sudo usermod -aG docker marcel
docker pull ubuntu:24.04

docker exec -itu <user> <mycontainer> bin/bash
add-apt-repository ppa:ondrej/php && apt update && apt upgrade

apt install apache2 ghostscript libapache2-mod-php8.3 mysql-server php8.3 php8.3-opcache php8.3-pdo php8.3-xml php8.3-apcu php8.3-bcmath php8.3-calendar php8.3-ctype php8.3-curl php8.3-dom php8.3-exif php8.3-ffi php8.3-fileinfo php8.3-ftp php8.3-gd php8.3-gettext php8.3-gmp php8.3-iconv php8.3-igbinary php8.3-imagick php8.3-intl php8.3-mbstring php8.3-mysqli php8.3-mysql php8.3-pdo php8.3-phar php8.3-posix php8.3-readline php8.3-shmop php8.3-simplexml php8.3-sockets php8.3-sysvmsg php8.3-sysvsem php8.3-sysvshm php8.3-tokenizer php8.3-xmlreader php8.3-xmlwriter php8.3-xsl php8.3-zip php8.3-redis

korrigieren

nano /etc/apache2/apache2.conf

sudo mkdir -p /srv/www/nextcloud/
sudo chown www-data: /srv/www/nextcloud
cd /srv/www/nextcloud && sudo -u www-data curl https://download.nextcloud.com/server/installer/setup-nextcloud.php -O -L

sudo touch /etc/apache2/sites-available/nextcloud.conf
sudo nano /etc/apache2/sites-available/nextcloud.conf

<VirtualHost *:80>
    ServerName cloud.marcel-solutions.de
    DocumentRoot /srv/www/nextcloud
    <Directory /srv/www/nextcloud>
        Options FollowSymLinks
        AllowOverride Limit Options FileInfo
        DirectoryIndex index.php
        Require all granted
    </Directory>
</VirtualHost>

a2ensite nextcloud
sudo a2enmod rewrite
sudo a2dissite 000-default
service apache2 reload

mysql -u root
CREATE DATABASE nextcloud_dba;
CREATE USER 'nextcloud_dbu'@'localhost' IDENTIFIED BY '<Passwort>';
GRANT ALL PRIVILEGES ON nextcloud_dba.* TO 'nextcloud_dbu'@localhost;
quit

#Nextcloud installieren

nano /srv/www/nextcloud/.htaccess

#<IfModule mod_dir.c>
#    DirectoryIndex index.php index.html
#</IfModule>

apt install python3 python3-dev python3-venv libaugeas-dev gcc
python3 -m venv /opt/certbot/
/opt/certbot/bin/pip install --upgrade pip
/opt/certbot/bin/pip install certbot certbot-apache
ln -s /opt/certbot/bin/certbot /usr/local/bin/certbot
certbot --apache
echo "0 0,12 * * * root /opt/certbot/bin/python -c 'import random; import time; time.sleep(random.random() * 3600)' && sudo certbot renew -q" | sudo tee -a /etc/crontab > /dev/null
/opt/certbot/bin/pip install --upgrade certbot certbot-apache

rm setup-nextcloud.php


